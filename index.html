<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<title>Czółko PRO - Sterowanie Ruchem</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<style>
html, body {
  margin: 0;
  padding: 0;
  height: 100%;
  font-family: Arial, sans-serif;
  background: #111;
  color: white;
  overflow: hidden;
}

#game-container {
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  height: 100%;
  width: 100%;
  box-sizing: border-box;
}

#orientation-warning {
  display: none;
  position: absolute;
  top: 0; left: 0;
  width: 100%; height: 100%;
  background: #111;
  color: white;
  justify-content: center;
  align-items: center;
  font-size: 5vw;
  z-index: 1000;
  text-align: center;
  flex-direction: column;
}

#timer {
  font-size: 5vw;
  margin: 10px;
  display: none;
}

#word {
  font-size: 10vw;
  font-weight: bold;
  text-align: center;
  padding: 10px;
  margin: 0;
  text-align: center;
}

#feedback {
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  font-size: 15vw;
  font-weight: bold;
  display: none;
}

#topic-select, #time-limit-container, #start-btn {
  margin: 10px;
}

select, input, button {
  font-size: 4vw;
  padding: 10px;
}

#start-btn {
  background: #2980b9;
  color: white;
  border: none;
  border-radius: 10px;
}

@media (orientation: portrait) {
  #orientation-warning {
    display: flex;
  }
  #game-container {
    display: none;
  }
}
</style>
</head>
<body>

<div id="orientation-warning">Proszę obrócić telefon w poziomie, aby grać!</div>

<div id="game-container">
  <div id="timer">Czas: 0</div>
  <div id="word">Kliknij START!</div>
  <div id="feedback"></div>

  <div id="topic-select">
    <select id="topic">
      <option value="zwierzeta">Zwierzeta</option>
      <option value="filmy">Filmy</option>
      <option value="postacie">Postacie</option>
    </select>
  </div>

  <div id="time-limit-container">
    <label>Czas (sekundy): <input type="number" id="time-limit" value="10" min="5" max="60"></label>
  </div>

  <button id="start-btn">START</button>
</div>

<script>
const wordsData = {
  zwierzeta: ["Kot","Pies","Słoń","Lew","Pingwin","Kaczka"],
  filmy: ["Shrek","Frozen","Harry Potter","Incepcja","Avengers"],
  postacie: ["Batman","Superman","Kaczor Donald","Myszka Miki"]
};

let currentWords = [];
let currentWord = "";
let timerInterval = null;
let timeLeft = 0;
let waitingForAnswer = false;

const wordDiv = document.getElementById("word");
const timerDiv = document.getElementById("timer");
const startBtn = document.getElementById("start-btn");
const topicSelect = document.getElementById("topic");
const timeLimitInput = document.getElementById("time-limit");
const timeLimitContainer = document.getElementById("time-limit-container");
const topicContainer = document.getElementById("topic-select");
const feedbackDiv = document.getElementById("feedback");

function startGame() {
  currentWords = [...wordsData[topicSelect.value]];
  startBtn.style.display = "none";
  topicContainer.style.display = "none";
  timeLimitContainer.style.display = "none";
  timerDiv.style.display = "block";

  if (typeof DeviceOrientationEvent !== 'undefined' && typeof DeviceOrientationEvent.requestPermission === 'function') {
    DeviceOrientationEvent.requestPermission()
      .then(response => {
        if (response === 'granted') {
          window.addEventListener("deviceorientation", handleOrientation);
        } else {
          alert("Brak dostępu do czujników ruchu!");
        }
      })
      .catch(console.error);
  } else {
    window.addEventListener("deviceorientation", handleOrientation);
  }

  nextWord();
}

function nextWord() {
  if(currentWords.length === 0){
    endGame();
    return;
  }
  const index = Math.floor(Math.random() * currentWords.length);
  currentWord = currentWords[index];
  currentWords.splice(index,1);
  wordDiv.textContent = currentWord;

  timeLeft = parseInt(timeLimitInput.value);
  timerDiv.textContent = `Czas: ${timeLeft}`;
  clearInterval(timerInterval);
  waitingForAnswer = true;

  timerInterval = setInterval(()=>{
    timeLeft--;
    timerDiv.textContent = `Czas: ${timeLeft}`;
    if(timeLeft<=0 && waitingForAnswer){
      clearInterval(timerInterval);
      waitingForAnswer = false;
      showFeedback("ŹLE");
    }
  },1000);
}

function showFeedback(result){
  feedbackDiv.textContent = result;
  feedbackDiv.style.display = "block";
  wordDiv.textContent = ""; // hasło znika
  wordDiv.style.background = result === "DOBRZE" ? "#27ae60" : "#c0392b";

  setTimeout(()=>{
    feedbackDiv.style.display = "none";
    wordDiv.style.background = "transparent";
    nextWord();
  },3000); // pokazuj 3 sekundy
}

function markCorrect(){
  if(!waitingForAnswer) return;
  waitingForAnswer = false;
  clearInterval(timerInterval);
  showFeedback("DOBRZE");
}

function markWrong(){
  if(!waitingForAnswer) return;
  waitingForAnswer = false;
  clearInterval(timerInterval);
  showFeedback("ŹLE");
}

function endGame(){
  wordDiv.textContent="Koniec rundy!";
  startBtn.style.display="block";
  topicContainer.style.display="flex";
  timeLimitContainer.style.display="flex";
  timerDiv.style.display="none";
  window.removeEventListener("deviceorientation", handleOrientation);
}

function handleOrientation(event){
  if(!waitingForAnswer) return;
  const beta = event.beta;
  if(beta > 15){ // przechylony do przodu -> ŹLE
    markWrong();
  } else if(beta < -15){ // przechylony do tyłu -> DOBRZE
    markCorrect();
  }
}

startBtn.addEventListener("click", startGame);
</script>

</body>
</html>
